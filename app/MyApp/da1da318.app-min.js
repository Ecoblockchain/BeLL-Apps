$(function(){App=new(Backbone.View.extend({Server:"",password:"oleoleole",wheel:null,Models:{},Views:{},Collections:{},Vars:{},globalUrl:{},collectionslist:null,idss:[],bellLocation:"Pakistan",el:"body",template:$("#template-app").html(),events:{"click .close":"closeModal"},start:function(){App.Router.PochDB();this.$el.html(_.template(this.template));var e=$.cookie("Member._id")?true:false;App.collectionslist=new App.Collections.listRCollection;App.collectionslist.fetch();if(!e&&$.url().attr("fragment")){window.location=$.url().attr("path")}else if(!e&&!$.url().attr("fragment")){Backbone.history.start({pushState:false});Backbone.history.navigate("login",{trigger:true})}else if(e&&!$.url().attr("fragment")){App.Router.renderNav();Backbone.history.start({pushState:false});Backbone.history.navigate("dashboard",{trigger:true})}else{App.Router.renderNav();Backbone.history.start({pushState:false})}},renderFeedback:function(){var e=new App.Models.report;var t=new App.Views.siteFeedback({model:e});t.render();App.$el.children(".body").append(t.el)},renderRequest:function(e){var t=new App.Views.RequestView;t.type=e;t.render();App.$el.children(".body").append(t.el);$("#site-request").animate({height:"302px"});document.getElementById("site-request").style.visibility="visible"},startActivityIndicator:function(){var e=document.getElementById("popup-spinning");if(App.wheel==null){App.wheel=new Spinner({lines:12,length:20,trail:40,width:5,radius:50,speed:2,color:"#34495E"}).spin(e)}else{App.wheel.spin(e)}},stopActivityIndicator:function(){window.setTimeout(function(){document.getElementById("cont").style.visibility="visible";App.wheel.stop()},1e3)},compileManifest:function(e,t){var n={manifestFileURL:"/apps/_design/bell/manifest.default.appcache",updateFileURL:"/apps/_design/bell/update.default.html"};var i="{replace me}";var a="# Compiled at "+(new Date).getTime()+"\n";App.once("compileManifest:go",function(){_.each(e,function(e,t,n){_.each(e,function(e){a+=encodeURI("/"+t+"/"+e._id)+"\n";if(_.has(e,"_attachments")){_.each(e._attachments,function(n,i,l){a+=encodeURI("/"+t+"/"+e._id+"/"+i)+"\n"})}})});App.trigger("compileManifest:replaceTextReady")});App.once("compileManifest:replaceTextReady",function(){$.get(n.manifestFileURL,function(e){var n=e.replace(i,a);$.getJSON(t,function(e){var i=new XMLHttpRequest;i.open("PUT",t+"/manifest.appcache?rev="+e._rev,true);i.onload=function(e){App.trigger("compileManifest:compiled")};i.setRequestHeader("Content-type","text/cache-manifest");i.send(new Blob([n],{type:"text/plain"}))})})});App.once("compileManifest:compiled",function(){$.get(n.updateFileURL,function(e){transformedUpdateHTML=e.replace("{time}",(new Date).getTime());$.getJSON(t,function(e){var n=new XMLHttpRequest;n.open("PUT",t+"/update.html?rev="+e._rev,true);n.onload=function(e){App.trigger("compileManifest:done")};n.setRequestHeader("Content-type","text/html");n.send(new Blob([transformedUpdateHTML],{type:"text/plain"}))})})});App.trigger("compileManifest:go")}}))});